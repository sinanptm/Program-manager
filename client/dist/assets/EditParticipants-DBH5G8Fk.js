import{u as $,r,$ as J,j as a,X as k,B as I,T as P,a0 as x,f as E,a1 as U,a as V,b as X,a2 as z}from"./index-Cdqi_yau.js";import{P as K}from"./ParticipantsList-CzqUF02Q.js";import{T as Y,F as v,I as f,S}from"./TextField-D-ULi0DR.js";import{A as M,u as Z,S as _,L as aa,P as ea}from"./ListSkeleton-CBzyakC8.js";import{F as ra}from"./FilterButton-BYugGuHf.js";import{A as ta}from"./AddButton-CptLbrMs.js";const oa={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4},sa=["lp","up","hs","hss","junior"],na=({open:b,handleClose:s})=>{const{data:j,isLoading:d,isError:c}=$(),[n,p]=r.useState(""),[u,m]=r.useState(""),[l,y]=r.useState(""),[o,g]=r.useState({}),[C]=J(),h=()=>{const e={};return n||(e.participantName="Participant name is required"),u||(e.teamId="Team selection is required"),l||(e.category="Category selection is required"),g(e),Object.keys(e).length===0},t=async()=>{if(h())try{await C({name:n,team:u,category:l}),p(""),m(""),y(""),g({}),s()}catch(e){console.error("Error adding participant:",e)}};return a.jsx(k,{open:b,onClose:s,"aria-labelledby":"add-participant-modal-title","aria-describedby":"add-participant-modal-description",children:a.jsxs(I,{sx:oa,children:[a.jsx(P,{id:"add-participant-modal-title",variant:"h6",component:"h2",children:"Add New Participant"}),a.jsx(Y,{margin:"normal",required:!0,fullWidth:!0,id:"participantName",label:"Participant Name",name:"participantName",autoFocus:!0,value:n,onChange:e=>p(e.target.value),error:!!o.participantName,helperText:o.participantName}),a.jsxs(v,{fullWidth:!0,required:!0,margin:"normal",error:!!o.teamId,children:[a.jsx(f,{id:"team-label",children:"Team"}),a.jsx(S,{labelId:"team-label",id:"teamId",value:u,onChange:e=>m(e.target.value),label:"Team",children:d?a.jsx(x,{disabled:!0,children:"Loading teams..."}):c?a.jsx(x,{disabled:!0,children:"Error loading teams"}):j.teams.map(e=>a.jsx(x,{value:e.id,children:e.name},e.id))}),o.teamId&&a.jsx(P,{color:"error",variant:"caption",children:o.teamId})]}),a.jsxs(v,{fullWidth:!0,required:!0,margin:"normal",error:!!o.category,children:[a.jsx(f,{id:"category-label",children:"Category"}),a.jsx(S,{labelId:"category-label",id:"category",value:l,onChange:e=>y(e.target.value),label:"Category",children:sa.map(e=>a.jsx(x,{value:e,children:e},e))}),o.category&&a.jsx(P,{color:"error",variant:"caption",children:o.category})]}),a.jsx(E,{variant:"contained",color:"primary",onClick:t,style:{marginTop:"16px"},children:"Add Participant"})]})})},ia={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4},la=({open:b,handleClose:s,participantId:j})=>{const[d,c]=r.useState(""),[n,p]=r.useState({}),[u,{isError:m,error:l}]=U(),{data:y,isLoading:o,isError:g}=V(),C=()=>{const t={};return d||(t.programId="Program selection is required"),p(t),Object.keys(t).length===0},h=async()=>{if(C())try{await u({id:j,programId:d}),c(""),p({}),s()}catch(t){console.error("Error adding program:",t)}};return a.jsx(k,{open:b,onClose:s,"aria-labelledby":"add-program-modal-title","aria-describedby":"add-program-modal-description",children:a.jsxs(I,{sx:ia,children:[a.jsx(P,{id:"add-program-modal-title",variant:"h6",component:"h2",children:"Add Program to Participant"}),m&&a.jsx(M,{severity:"error",style:{marginBottom:"16px"},children:l.data.message}),a.jsxs(v,{fullWidth:!0,required:!0,margin:"normal",error:!!n.programId,children:[a.jsx(f,{id:"program-label",children:"Program Name"}),a.jsx(S,{labelId:"program-label",id:"programId",value:d,onChange:t=>c(t.target.value),label:"Program Name",children:o?a.jsx(x,{disabled:!0,children:"Loading programs..."}):g?a.jsx(x,{disabled:!0,children:"Error loading programs"}):y.programs.map(t=>a.jsx(x,{value:t.id,children:t.name},t.id))}),n.programId&&a.jsx(P,{color:"error",variant:"caption",children:n.programId})]}),a.jsx(E,{variant:"contained",color:"primary",onClick:h,style:{marginTop:"16px"},children:"Add Program"})]})})},ha=()=>{var T;const[b,s]=r.useState(1),[j,d]=r.useState(""),[c,n]=r.useState(""),p=10,u=Z(c,300),{data:m,error:l,isLoading:y,isFetching:o}=X({page:b,limit:p,category:j,search:u}),[g,{isError:C,error:h}]=z(),[t,e]=r.useState(!1),[w,A]=r.useState(!1),[F,N]=r.useState(null),L=r.useCallback(()=>e(!1),[]),q=r.useCallback(()=>A(!1),[]),B=r.useCallback(i=>{d(i),s(1)},[]),O=r.useCallback(i=>{n(i.target.value),s(1)},[]),W=r.useCallback(async i=>{try{await g(i).unwrap()}catch(R){console.error("Error deleting participant:",R)}},[g]),G=r.useCallback(i=>{N(i),A(!0)},[]),Q=r.useCallback(()=>e(!0),[]),D=r.useCallback(i=>{s(i)},[]),H=[{label:"All",value:""},{label:"LP",value:"lp"},{label:"UP",value:"up"},{label:"HS",value:"hs"},{label:"HSS",value:"hss"},{label:"Junior",value:"junior"}];return a.jsxs(a.Fragment,{children:[a.jsx(P,{variant:"h4",align:"center",gutterBottom:!0,children:"Participants"}),a.jsxs(I,{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"16px",children:[a.jsx(ta,{onClick:Q,label:"Add"}),a.jsx(_,{label:"Search",value:c,onChange:O,placeholder:"Search participants..."}),a.jsx(ra,{label:"Category",options:H,selectedValue:j,onChange:B})]}),(C||l)&&a.jsx(M,{severity:"error",children:((T=h==null?void 0:h.data)==null?void 0:T.message)??l.message}),y||o?a.jsx(aa,{rows:10,columns:6}):a.jsxs(a.Fragment,{children:[a.jsx(K,{participants:m.participants,actions:{remove:!0,edit:!0,addProgram:!0},handleRemove:W,handleAddProgram:G}),a.jsx(ea,{page:b,totalPages:m.totalPages,onPageChange:D})]}),a.jsx(na,{open:t,handleClose:L}),a.jsx(la,{open:w,handleClose:q,participantId:F})]})};export{ha as default};
