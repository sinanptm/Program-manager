import{u as R,r,a0 as J,j as a,Y as E,B as v,T as P,a1 as h,g as k,a2 as U,a as V,b as Y,a3 as $,C as z}from"./index-CLFLJj7i.js";import{P as K}from"./ParticipantsList-CxYFs-Wn.js";import{T as X,F as f,I as S,S as I}from"./TextField-Bfifr5H5.js";import{A as M,u as Z,S as _,P as aa}from"./Pagination-TmjqAlHS.js";import{F as ea}from"./FilterButton-rNzfEMmA.js";import{A as ra}from"./AddButton-A5j_oxtx.js";const ta={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4},oa=["lp","up","hs","hss","junior"],sa=({open:x,handleClose:s})=>{const{data:b,isLoading:d,isError:c}=R(),[n,p]=r.useState(""),[u,m]=r.useState(""),[l,j]=r.useState(""),[o,y]=r.useState({}),[g]=J(),C=()=>{const e={};return n||(e.participantName="Participant name is required"),u||(e.teamId="Team selection is required"),l||(e.category="Category selection is required"),y(e),Object.keys(e).length===0},t=async()=>{if(C())try{await g({name:n,team:u,category:l}),p(""),m(""),j(""),y({}),s()}catch(e){console.error("Error adding participant:",e)}};return a.jsx(E,{open:x,onClose:s,"aria-labelledby":"add-participant-modal-title","aria-describedby":"add-participant-modal-description",children:a.jsxs(v,{sx:ta,children:[a.jsx(P,{id:"add-participant-modal-title",variant:"h6",component:"h2",children:"Add New Participant"}),a.jsx(X,{margin:"normal",required:!0,fullWidth:!0,id:"participantName",label:"Participant Name",name:"participantName",autoFocus:!0,value:n,onChange:e=>p(e.target.value),error:!!o.participantName,helperText:o.participantName}),a.jsxs(f,{fullWidth:!0,required:!0,margin:"normal",error:!!o.teamId,children:[a.jsx(S,{id:"team-label",children:"Team"}),a.jsx(I,{labelId:"team-label",id:"teamId",value:u,onChange:e=>m(e.target.value),label:"Team",children:d?a.jsx(h,{disabled:!0,children:"Loading teams..."}):c?a.jsx(h,{disabled:!0,children:"Error loading teams"}):b.teams.map(e=>a.jsx(h,{value:e.id,children:e.name},e.id))}),o.teamId&&a.jsx(P,{color:"error",variant:"caption",children:o.teamId})]}),a.jsxs(f,{fullWidth:!0,required:!0,margin:"normal",error:!!o.category,children:[a.jsx(S,{id:"category-label",children:"Category"}),a.jsx(I,{labelId:"category-label",id:"category",value:l,onChange:e=>j(e.target.value),label:"Category",children:oa.map(e=>a.jsx(h,{value:e,children:e},e))}),o.category&&a.jsx(P,{color:"error",variant:"caption",children:o.category})]}),a.jsx(k,{variant:"contained",color:"primary",onClick:t,style:{marginTop:"16px"},children:"Add Participant"})]})})},na={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4},ia=({open:x,handleClose:s,participantId:b})=>{const[d,c]=r.useState(""),[n,p]=r.useState({}),[u,{isError:m,error:l}]=U(),{data:j,isLoading:o,isError:y}=V(),g=()=>{const t={};return d||(t.programId="Program selection is required"),p(t),Object.keys(t).length===0},C=async()=>{if(g())try{await u({id:b,programId:d}),c(""),p({}),s()}catch(t){console.error("Error adding program:",t)}};return a.jsx(E,{open:x,onClose:s,"aria-labelledby":"add-program-modal-title","aria-describedby":"add-program-modal-description",children:a.jsxs(v,{sx:na,children:[a.jsx(P,{id:"add-program-modal-title",variant:"h6",component:"h2",children:"Add Program to Participant"}),m&&a.jsx(M,{severity:"error",style:{marginBottom:"16px"},children:l.data.message}),a.jsxs(f,{fullWidth:!0,required:!0,margin:"normal",error:!!n.programId,children:[a.jsx(S,{id:"program-label",children:"Program Name"}),a.jsx(I,{labelId:"program-label",id:"programId",value:d,onChange:t=>c(t.target.value),label:"Program Name",children:o?a.jsx(h,{disabled:!0,children:"Loading programs..."}):y?a.jsx(h,{disabled:!0,children:"Error loading programs"}):j.programs.map(t=>a.jsx(h,{value:t.id,children:t.name},t.id))}),n.programId&&a.jsx(P,{color:"error",variant:"caption",children:n.programId})]}),a.jsx(k,{variant:"contained",color:"primary",onClick:C,style:{marginTop:"16px"},children:"Add Program"})]})})},ga=()=>{var T;const[x,s]=r.useState(1),[b,d]=r.useState(""),[c,n]=r.useState(""),p=10,u=Z(c,300),{data:m,error:l,isLoading:j}=Y({page:x,limit:p,category:b,search:u}),[o,{isError:y,error:g}]=$(),[C,t]=r.useState(!1),[e,A]=r.useState(!1),[w,N]=r.useState(null),F=r.useCallback(()=>t(!1),[]),q=r.useCallback(()=>A(!1),[]),B=r.useCallback(i=>{d(i),s(1)},[]),L=r.useCallback(i=>{n(i.target.value),s(1)},[]),O=r.useCallback(async i=>{try{await o(i).unwrap()}catch(H){console.error("Error deleting participant:",H)}},[o]),W=r.useCallback(i=>{N(i),A(!0)},[]),G=r.useCallback(()=>t(!0),[]),Q=r.useCallback(i=>{s(i)},[]);if(j)return a.jsx(v,{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",children:a.jsx(z,{})});const D=[{label:"All",value:""},{label:"LP",value:"lp"},{label:"UP",value:"up"},{label:"HS",value:"hs"},{label:"HSS",value:"hss"},{label:"Junior",value:"junior"}];return a.jsxs(a.Fragment,{children:[a.jsx(P,{variant:"h4",align:"center",gutterBottom:!0,children:"Participants"}),a.jsxs(v,{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"16px",children:[a.jsx(ra,{onClick:G,label:"Add"}),a.jsx(_,{label:"Search",value:c,onChange:L,placeholder:"Search participants..."}),a.jsx(ea,{label:"Category",options:D,selectedValue:b,onChange:B})]}),(y||l)&&a.jsx(M,{severity:"error",children:((T=g==null?void 0:g.data)==null?void 0:T.message)??l.message}),a.jsx(K,{participants:m.participants,actions:{remove:!0,edit:!0,addProgram:!0},handleRemove:O,handleAddProgram:W}),a.jsx(aa,{page:x,totalPages:m.totalPages,onPageChange:Q}),a.jsx(sa,{open:C,handleClose:F}),a.jsx(ia,{open:e,handleClose:q,participantId:w})]})};export{ga as default};
